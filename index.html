<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Embed Code</title>

    
</head>
<body style="width:80%; max-width:900px; margin:auto; padding:40px;">

    <h1>School Story Embed Code Generator</h1>

    <form method="get">
        <label for="video-id">Video ID:</label>
        <input type="text" value="" id="vid-input" name="vid">
        <br>
        <label for="ar">Aspect Ratio:</label>
        <select name="ar" id="ar-input">
            <option value="16:9">16:9</option>
            <option value="9:16">9:16</option>
            <option value="1:1">1:1</option>
        </select>
        <br>
        <label for="poster">Poster (seconds):</label>
        <input type="text" value="4" id="poster-input" name="poster">
        <br>
        <button type="submit">Generate</button>
      </form>
    <br>

    <code>Live Demo</code>

    <div id="exampleContainer">
    </div>

    <br>

    <code>
        Embed Code:
    </code>
   
    <script>

        var videoIDInput = document.getElementById("vid-input");
        var ARInput = document.getElementById("ar-input");
        var PosterInput = document.getElementById("poster-input");

        let params = new URLSearchParams(document.location.search);

        // Get input values
        let videoId = params.get('vid');
        let aspectRatio = params.get('ar');
        let posterSeconds = params.get('poster');

        var thumbtimestame="0s";
        if(posterSeconds){
            thumbtimestame=posterSeconds+"s";
            PosterInput.value=posterSeconds;
        }


        //set the video id
        if (videoId) {
            videoIDInput.value=videoId;
        


            // Set aspect ratio
            if (aspectRatio) {
                ARInput.value=aspectRatio;
            var [width, height] = aspectRatio.split(':');
            

            }    
            

            // Create embed code element
            const sampleCode = document.createElement('textarea');
            
            // Generate embed code
            sampleCode.value =
            `<div style="border:1px solid rgba(0, 0, 0, 0);background-color: #000000;color:#9CA1B2;text-align: center; text-align: left;"><div style="position: relative; padding-top: ${height/width*100}%;"><iframe src="https://customer-scwb94clidwa8d1o.cloudflarestream.com/${videoId}/iframe?poster=https%3A%2F%2Fcustomer-scwb94clidwa8d1o.cloudflarestream.com%2F${videoId}%2Fthumbnails%2Fthumbnail.jpg%3Ftime%3D${thumbtimestame}%26height%3D600" style="border: none; position: absolute; top: 0; left: 0; height: 100%; width: 100%;" allow="accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;" allowfullscreen="true"></iframe></div><div style="padding: 0 17px 0 17px;"><a style="border:none; box-shadow:none; background-color:#000000;" href="https://dash.marketing/school-story/?utm_source=School%20Story&utm_medium=Video%20Embed" target="_blank"><img src="https://dashmedia.github.io/cfstream-ssvideo/stamp.png" style="height:10px; background-color: #000000; padding:17px 0px; display:block;" alt="Powered by School Story"/></a></div></div>`;

            sampleCode.style = 'width:100%;height:100px;';
        
            // Append embed code to body
            document.body.appendChild(sampleCode);

            var exampleContainer = document.getElementById("exampleContainer");

            exampleContainer.innerHTML=sampleCode.value;


            var downloadURLLabel = document.createElement('code');
            downloadURLLabel.innerHTML='Download URL';
            document.body.appendChild(downloadURLLabel);


            // Create downloadURL element
            const downloadURL = document.createElement('textarea');

            downloadURL.value=`https://customer-scwb94clidwa8d1o.cloudflarestream.com/${videoId}/downloads/default.mp4`;

            downloadURL.style = 'width:100%;';

            document.body.appendChild(downloadURL);

            
        }
    </script>



</body>
</html>
